/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@angular/core"),require("@angular/platform-browser"),require("rxjs/observable/of"),require("rxjs/operators/filter"),require("rxjs/operators/tap"),require("rxjs/operators/take")):"function"==typeof define&&define.amd?define("@nguniversal/common",["exports","@angular/common/http","@angular/core","@angular/platform-browser","rxjs/observable/of","rxjs/operators/filter","rxjs/operators/tap","rxjs/operators/take"],t):t((e.nguniversal=e.nguniversal||{},e.nguniversal.common={}),e.ng.common.http,e.ng.core,e.ng.platformBrowser,e.Rx.Observable,e.Rx.operators,e.Rx.operators,e.Rx.operators)}(this,function(e,t,r,a,o,s,n,i){"use strict";function u(e){for(var t={},r=0,a=e.keys();r<a.length;r++){var o=a[r];t[o]=e.getAll(o)}return t}var p=function(){function e(e,t){var r=this;this.transferState=t,this.isCacheActive=!0,e.isStable.pipe(s.filter(function(e){return e}),i.take(1)).toPromise().then(function(){r.isCacheActive=!1})}return e.prototype.invalidateCacheEntry=function(e){this.transferState.remove(a.makeStateKey("G."+e)),this.transferState.remove(a.makeStateKey("H."+e))},e.prototype.intercept=function(e,r){var s=this;if("GET"!==e.method&&"HEAD"!==e.method&&(this.isCacheActive=!1,this.invalidateCacheEntry(e.url)),!this.isCacheActive)return r.handle(e);var i=("GET"===e.method?"G.":"H.")+e.url,p=a.makeStateKey(i);if(this.transferState.hasKey(p)){var f=this.transferState.get(p,{});return o.of(new t.HttpResponse({body:f.body,headers:new t.HttpHeaders(f.headers),status:f.status,statusText:f.statusText,url:f.url}))}return r.handle(e).pipe(n.tap(function(e){e instanceof t.HttpResponse&&s.transferState.set(p,{body:e.body,headers:u(e.headers),status:e.status,statusText:e.statusText,url:e.url})}))},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:r.ApplicationRef},{type:a.TransferState}]},e}(),f=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{imports:[a.BrowserTransferStateModule],providers:[p,{provide:t.HTTP_INTERCEPTORS,useExisting:p,multi:!0}]}]}],e.ctorParameters=function(){return[]},e}();e.TransferHttpCacheModule=f,e.Éµa=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=common.umd.min.js.map
